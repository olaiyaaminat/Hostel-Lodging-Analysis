Create Database Student_Lodging_Information_Management_System;

------CREATING TABLE 

CREATE TABLE STUDENT(
StudentID     VARCHAR(90) PRIMARY KEY,
StudentName  VARCHAR(90) NOT NULL,
Gender VARCHAR(90),
Age  VARCHAR(90),
Email VARCHAR(90),
Phoneno  INTEGER
);


CREATE TABLE ROOMTYPE(
RoomtypeID    INTEGER PRIMARY KEY,
Description     VARCHAR(90),
Capacity VARCHAR(90)
);


CREATE TABLE HOSTEL(
HostelID     INTEGER PRIMARY KEY,
Name     VARCHAR(90),
Email VARCHAR(90), 
Checkintime  time,
Checkouttime  time,
PhoneNumber INTEGER
);

CREATE TABLE STAFF(
StaffID     INTEGER  PRIMARY KEY,
Name     VARCHAR(90),
Position VARCHAR(90), 
Salary     VARCHAR(90),
Age       VARCHAR(90),
PhoneNumber INTEGER,
HostelID     INTEGER,
FOREIGN KEY (HOSTELID)REFERENCES HOSTEL (HOSTELID)
);

CREATE TABLE ROOM(
RoomID     INTEGER PRIMARY KEY,
Status     VARCHAR(90),
HostelID     INTEGER,
RoomtypeID    INTEGER,
FOREIGN KEY (HOSTELID) REFERENCES HOSTEL (HOSTELID),
FOREIGN KEY (ROOMTYPEID) REFERENCES ROOMTYPE (ROOMTYPEID)
);


CREATE TABLE BOOKING(
BookingID     VARCHAR(90)PRIMARY KEY,
Checkindate      VARCHAR(90),
Checkoutdate VARCHAR(90), 
Weeklyprice INTEGER,
StudentID     VARCHAR(90),
RoomID     INTEGER,
FOREIGN KEY (STUDENTID) REFERENCES STUDENT (STUDENTID),
FOREIGN KEY (ROOMID) REFERENCES ROOM (ROOMID)
);


CREATE TABLE PAYMENT(
PaymentID     VARCHAR(90)PRIMARY KEY,
Paymentdate VARCHAR(90),
Paymentmethod VARCHAR(90),
Amount  VARCHAR(90), 
BookingID     VARCHAR(90),
FOREIGN KEY (BOOKINGID) REFERENCES BOOKING (BOOKINGID)
);



-----DATA ENTRY TO TABLES

INSERT INTO STUDENT VALUES ('MY00001', 'Bryant Thornton','Male', '25', NULL,012345678);
INSERT INTO STUDENT VALUES ('ID00001', 'Sergio Mejia','Female', '19', NULL,056789012);
INSERT INTO STUDENT VALUES ('SG00001', 'Bella Guerrero','Male', '22', NULL,067890123);
INSERT INTO STUDENT VALUES ('SG00002', 'Lauren Conner','Male', '20', NULL,078901234);
INSERT INTO STUDENT VALUES ('SG00003', 'Bella Guerrero','Male', '22', NULL,067890123);
INSERT INTO STUDENT VALUES ('TH00001', 'Clark Berry','Male', '31', NULL,0890123456);
INSERT INTO STUDENT VALUES ('SG00004', 'Gaven Pennington','Male', '25', NULL,001234567);
INSERT INTO STUDENT VALUES ('MY00009', 'Bryant Thorn','Male', '25', NULL,0012345699);
INSERT INTO STUDENT VALUES ('SG00008', 'Bellin Guerreroh','Male', '22', NULL,02345677);
INSERT INTO STUDENT VALUES ('SG00007', 'Gaven Pennin','Male', '25', NULL,001234567);
INSERT INTO STUDENT VALUES ('STH00003', 'Ben Krueger','Female', '18', NULL,054321098);
INSERT INTO STUDENT VALUES ('MY00003', 'Jamison Eaton','Female', '17', NULL,043210987);


INSERT INTO ROOMTYPE VALUES (7, 'ENSUITE','3');
INSERT INTO ROOMTYPE VALUES (8, 'DOUBLE BED','2');
INSERT INTO ROOMTYPE VALUES (9, 'PRIVATE','7');
INSERT INTO ROOMTYPE VALUES (10, 'SINGLE BED','5');


INSERT INTO HOSTEL VALUES (1, 'Obsidian Sky','Obsidiansky@gmailcom', '03:56:14', '11:21:32', '010987654');
INSERT INTO HOSTEL VALUES (2, 'Rodeway Inn','RodewayInn@gmail.com', '17:20:56', '06:19:03', '0098706543');
INSERT INTO HOSTEL VALUES (3, 'Hillside Hotel','HillsideHotel@gmailcom', '20:11:36', '7:58:55', '00987605432');
INSERT INTO HOSTEL VALUES (4, 'Planters Inn','PlantersInn@gmail.com', '18:38:21', '14:35:57', '0087654321');


INSERT INTO STAFF VALUES (8, 'Rory Kennedy','Manager', '100,000', '50','098765432','1');
INSERT INTO STAFF VALUES (9, 'Isai Branch','Receptionist', '40,000', '23','087654321','2');
INSERT INTO STAFF VALUES (5, 'Kaitlyn Gregory','Assit Manager', '80,000', '32','076543210','3');
INSERT INTO STAFF VALUES (6, 'Cade Ewing','Manager', '100,000', '45','0765432101','4');
INSERT INTO STAFF VALUES (4, 'Cadeh clan','Director', '150,000', '48','0765567101','4');
INSERT INTO STAFF VALUES (11, 'Isaiy Brace','cleaner', '20,000', '29','0876567821','2');


INSERT INTO ROOM VALUES (2, 'OCCUPIED','1', '7');
INSERT INTO ROOM VALUES (3, 'OCCUPIED','2', '7');
INSERT INTO ROOM VALUES (1, 'OCCUPIED','3', '8');
INSERT INTO ROOM VALUES (4, 'OCCUPIED','4', '9');
INSERT INTO ROOM VALUES (7, 'OCCUPIED','2', '8');
INSERT INTO ROOM VALUES (9, 'OCCUPIED','3', '10');
INSERT INTO ROOM VALUES (11, 'OCCUPIED','3', '8');
INSERT INTO ROOM VALUES (12, 'OCCUPIED','3', '8');
INSERT INTO ROOM VALUES (13, 'OCCUPIED','1', '8');
INSERT INTO ROOM VALUES (17, 'OCCUPIED','4', '7');
INSERT INTO ROOM VALUES (22, 'OCCUPIED','4', '9');
INSERT INTO ROOM VALUES (24, 'OCCUPIED','2', '9');




INSERT INTO BOOKING VALUES ('DDMY00001', '1/12/2010','2/24/2010', '155', 'MY00001',2);
INSERT INTO BOOKING VALUES ('DDID00002', '1/21/2010','10/2/2011', '154', 'ID00001',3);
INSERT INTO BOOKING VALUES ('DDSG00003', '1/2/2010','1/10/2010', '162', 'SG00001',1);
INSERT INTO BOOKING VALUES ('DDSG00004', '1/5/2011','1/4/2012', '430', 'SG00002',4);
INSERT INTO BOOKING VALUES ('DDKH00005', '1/8/2011','1/8/2012', '162', 'SG00003',3);
INSERT INTO BOOKING VALUES ('DDDTH00006', '1/3/2011','1/15/2012', '162', 'TH00001',3);
INSERT INTO BOOKING VALUES ('DDTH00007', '1/8/2011','1/16/2011', '198', 'SG00004',1);
INSERT INTO BOOKING VALUES ('DDMY00008', '2/25/2010','1/17/2012', '80', 'MY00009',2);
INSERT INTO BOOKING VALUES ('DDSG00009', '1/12/2011','1/2/2012', '98', 'SG00008',3);
INSERT INTO BOOKING VALUES ('DDSG00010', '1/20/2011','1/13/2012', '121', 'SG00007',1);
INSERT INTO BOOKING VALUES ('DDTH00011', '1/17/2011','1/9/2012', '203', 'STH00003',2);
INSERT INTO BOOKING VALUES ('DDMY00012', '1/2/2010','1/24/2012', '281', 'MY00003',4);



INSERT INTO PAYMENT VALUES ('P001', '1/12/2010','Debit Card', '960', 'DDMY00001');
INSERT INTO PAYMENT VALUES ('P002', '1/21/2010','Internet Banking', '1,848', 'DDID00002');
INSERT INTO PAYMENT VALUES ('P003', '1/2/2010','Internet Banking', '162', 'DDSG00003');
INSERT INTO PAYMENT VALUES ('P004', '11/5/2011','Debit Card', '5,160', 'DDSG00004');
INSERT INTO PAYMENT VALUES ('P005', '1/8/2011','Debit Card', '1,944', 'DDKH00005');
INSERT INTO PAYMENT VALUES ('P006', '1/3/2011','Credit Card', '1,944', 'DDDTH00006');
INSERT INTO PAYMENT VALUES ('P007', '1/8/2011','Credit Card', '1,944', 'DDTH00007');
INSERT INTO PAYMENT VALUES ('P008', '2/27/2010','Credit Card', '1,845', 'DDMY00008');
INSERT INTO PAYMENT VALUES ('P009', '1/12/2011','Credit Card', '1,176', 'DDSG00009');
INSERT INTO PAYMENT VALUES ('P010', '1/23/2011','Internet Banking', '1,452', 'DDSG00010');
INSERT INTO PAYMENT VALUES ('P011', '1/17/2011','Credit Card', '2,436', 'DDTH00011');
INSERT INTO PAYMENT VALUES ('P012', '1/2/2010','Internet Banking', '3,372', 'DDMY00012');


----- DISPLAYING OF DATA TABLES
 SELECT *
FROM STUDENT
ORDER BY AGE DESC;

SELECT *
FROM BOOKING
ORDER BY WEEKLYPRICE DESC;

SELECT *
FROM PAYMENT
ORDER BY PAYMENTID ASC;

SELECT *
FROM ROOM
ORDER BY ROOMID ASC;

SELECT *
FROM ROOMTYPE
ORDER BY ROOMTYPEID ASC;

SELECT *
FROM HOSTEL
ORDER BY HOSTELID DESC;

SELECT *
FROM STAFF
ORDER BY AGE DESC;


-------- DQL1

SELECT RoomType.Description, 
COUNT(Booking.BookingID) AS BookingCount 
FROM RoomType 
LEFT JOIN Room ON RoomType.RoomTypeID = Room.RoomTypeID 
LEFT JOIN Booking ON Room.RoomID = Booking.RoomID 
GROUP BY RoomType.RoomTypeID, RoomType.Description
ORDER BY BookingCount DESC; 


-------DQL2

SELECT Hostel.Name, 
COUNT(Booking.BookingID) / COUNT(Room.RoomID) AS OccupancyRate 
FROM Hostel 
LEFT JOIN Room ON Hostel.HostelID = Room.HostelID 
LEFT JOIN Booking ON Room.RoomID = Booking.RoomID
GROUP BY Hostel.HostelID, Hostel.Name; 

-----DQL3
SELECT Hostel.Name, 
SUM(Payment.Amount) AS TotalRevenue
FROM Hostel
LEFT JOIN Room ON Hostel.HostelID = Room.HostelID
LEFT JOIN Booking ON Room.RoomID = Booking.RoomID
LEFT JOIN Payment ON Booking.BookingID = Payment.BookingID
GROUP BY Hostel.HostelID, Hostel.Name;


-----------DQL4
SELECT Booking.BookingID, StudentName, Payment.Amount, Payment.PaymentDate
FROM Booking
INNER JOIN Payment ON Booking.BookingID = Payment.BookingID
INNER JOIN Student ON Booking.StudentID = Student.StudentID
WHERE Payment.PaymentDate > Booking.CheckOutDate


-----------DQL5
SELECT Hostel.Name, 
COUNT(Booking.StudentID) AS Number_Of_Students
FROM Hostel
LEFT JOIN Room ON Hostel.HostelID = Room.HostelID
LEFT JOIN Booking ON Room.RoomID = Booking.RoomID
GROUP BY Hostel.HostelID, Hostel.Name;


-----------DQL6
SELECT Payment.PaymentMethod,
COUNT(Payment.PaymentID) AS PaymentCount
FROM Payment
GROUP BY Payment.PaymentMethod;
